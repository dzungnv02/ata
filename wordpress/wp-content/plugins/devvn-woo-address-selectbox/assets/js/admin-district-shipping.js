!function(a,e,i,o){var n=i.template("district-rate-box-row-template"),t=a("#flat_rate_boxes"),s=t.find("tbody.flat_rate_boxes"),c={init:function(){t.on("click","a.add-box",this.onAddRate).on("click","a.remove",this.onRemoveRate);var e=s.data("boxes");a(e).each(function(i){var t=s.find(".flat_rate_box").length;s.append(n({box:e[i],index:t}))}),s.sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort_dwas_td",scrollSensitivity:40,helper:function(i,t){return t.children().each(function(){a(this).width(a(this).width())}),t.css("left","0"),t},start:function(i,t){t.item.css("background-color","#f6f6f6")},stop:function(i,t){t.item.removeAttr("style"),c.reindexRows()}})},onAddRate:function(i){i.preventDefault();var t=s,e=t.find(".flat_rate_box").length;t.append(n({box:{box_id:"",box_district:"",box_cost:"",box_title:""},index:e})),a(".chosen_select").select2()},onRemoveRate:function(i){if(i.preventDefault(),confirm(e.i18n.delete_rates)){var n=[];s.find("tr td.check-column input:checked").each(function(i,t){var e=a(t).closest("tr.flat_rate_box").find(".box_id").val();n.push(e),a(t).closest("tr.flat_rate_box").addClass("deleting")});var t={action:"woocommerce_district_rate_box_delete",box_id:n,security:e.delete_box_nonce};a.post(o,t,function(i){a("tr.deleting").fadeOut("300",function(){a(this).remove()})})}},reindexRows:function(){var n=0;s.find("tr").each(function(i,t){a("input.text, input.checkbox, select.select",t).each(function(i,t){var e=a(t);e.attr("name",e.attr("name").replace(/\[([^[]*)\]/,"["+n+"]"))}),a("input.input_district_condition",t).each(function(i,t){var e=a(t);e.attr("name",e.attr("name").replace(/\[([^[]*)\]/,"["+n+"]"))}),n++})}};c.init(),a(document).ready(function(){a(".shipping_advance").live("change",function(){var i=a(this).parents(".district_shipping_advance").find(".dwas_price_list");i.hasClass("dwas_hidden")&&a(this).is(":checked")?i.removeClass("dwas_hidden").addClass("dwas_show"):i.addClass("dwas_hidden").removeClass("dwas_show")}),a(".shipping_advance_w").live("change",function(){var i=a(this).parents(".district_shipping_advance_weight").find(".dwas_price_list");i.hasClass("dwas_hidden")&&a(this).is(":checked")?i.removeClass("dwas_hidden").addClass("dwas_show"):i.addClass("dwas_hidden").removeClass("dwas_show")}),a(".dwas_add_condition").live("click",function(){var i=a(this).parents(".district_shipping_advance"),t=i.find(".dwas_price_list_tr").eq(1).clone();t.find("input").val("").attr("value",""),a(".dwas_price_list_box",i).append(t);var n=-1;return a(".dwas_price_list_box .dwas_price_list_tr",i).each(function(i,t){a("input.input_district_condition",t).each(function(i,t){var e=a(t);e.attr("name",e.attr("name").replace(/\[dk_([^[]*)\]/,"[dk_"+n+"]"))}),n++}),!1}),a(".dwas_delete_condition").live("click",function(){var i=a(this).parents(".dwas_price_list_tr"),t=a(this).parents(".dwas_price_list_box");return 2<a(".dwas_price_list_tr",t).length&&i.fadeOut(400,function(){a(this).remove();var n=-1;a(".dwas_price_list_tr",t).each(function(i,t){a("input.input_district_condition",t).each(function(i,t){var e=a(t);e.attr("name",e.attr("name").replace(/\[dk_([^[]*)\]/,"[dk_"+n+"]"))}),n++})}),!1}),0<a("#woocommerce_devvn_district_zone_shipping_all_price_condition").length&&(a("#woocommerce_devvn_district_zone_shipping_all_price_condition").closest("tr").css("display","none"),a("body").on("click",".dwas_save_condition, .all_condition_district > label",function(){var t=!1,i=a("#mainform").serialize();t||a.ajax({type:"post",dataType:"json",url:o,data:{action:"woocommerce_district_rate_array_to_serialize",data_form:i},context:this,beforeSend:function(){t=!0,a(".district_shipping_advance.all_condition_district").addClass("loading")},success:function(i){i.success&&a("#woocommerce_devvn_district_zone_shipping_all_price_condition").val(i.data),a(".district_shipping_advance.all_condition_district").removeClass("loading"),t=!1}})})),0<a("#woocommerce_devvn_district_zone_shipping_all_price_condition_w").length&&(a("#woocommerce_devvn_district_zone_shipping_all_price_condition_w").closest("tr").css("display","none"),a("body").on("click",".dwas_save_condition_w, .all_condition_district_w > label",function(){var t=!1,i=a("#mainform").serialize();t||a.ajax({type:"post",dataType:"json",url:o,data:{action:"woocommerce_district_rate_array_to_serialize_weight",data_form:i},context:this,beforeSend:function(){t=!0,a(".district_shipping_advance.all_condition_district_w").addClass("loading")},success:function(i){i.success&&a("#woocommerce_devvn_district_zone_shipping_all_price_condition_w").val(i.data),a(".district_shipping_advance.all_condition_district_w").removeClass("loading"),t=!1}})}))})}(jQuery,woocommerce_district_shipping_rate_rows,wp,ajaxurl);